<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agendei</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
--primary:#b993d6;
--secondary:#8ca6db;
--bg:#f5f7fa;
--card:#ffffff;
--text:#1e1e1e;
}

.dark{
--bg:#111827;
--card:#1f2937;
--text:#f3f4f6;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Inter;}

body{
background:var(--bg);
color:var(--text);
display:flex;
min-height:100vh;
}

.sidebar{
width:240px;
background:linear-gradient(180deg,var(--primary),var(--secondary));
padding:30px 20px;
color:white;
display:flex;
flex-direction:column;
}

.logo{
font-size:24px;
font-weight:700;
margin-bottom:40px;
}

.nav-btn{
background:none;
border:none;
color:white;
text-align:left;
padding:12px 0;
cursor:pointer;
font-size:14px;
}

.main{
flex:1;
padding:40px;
}

.card{
background:var(--card);
padding:25px;
border-radius:16px;
box-shadow:0 10px 30px rgba(0,0,0,0.05);
margin-bottom:25px;
}

input,select{
width:100%;
padding:12px;
margin-top:10px;
border-radius:8px;
border:1px solid #ddd;
}

button{
margin-top:10px;
padding:12px;
border:none;
border-radius:8px;
cursor:pointer;
background:linear-gradient(90deg,var(--primary),var(--secondary));
color:white;
font-weight:600;
}

.hidden{display:none;}

.topbar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:30px;
}

.agendamento-item{
padding:10px;
border-bottom:1px solid #eee;
font-size:14px;
}

.toggle-dark{
cursor:pointer;
}
</style>
</head>

<body>

<div id="loginScreen" style="margin:auto;max-width:400px;width:100%;">
<div class="card">
<h2 style="text-align:center;margin-bottom:20px;">Agendei</h2>
<input id="email" placeholder="Email">
<input id="senha" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
</div>
</div>

<div id="app" class="hidden">

<div class="sidebar">
<div class="logo">Agendei</div>
<button class="nav-btn" onclick="showTab('agendar')">Agendar</button>
<button class="nav-btn" onclick="showTab('agendei')">Agendei</button>
<button class="nav-btn" onclick="showTab('config')">Configurações</button>
<button class="nav-btn toggle-dark" onclick="toggleDark()">Modo Escuro</button>
<button class="nav-btn" onclick="logout()">Sair</button>
</div>

<div class="main">

<div class="topbar">
<h2 id="tituloAba">Agendar</h2>
</div>

<div id="agendar" class="tab">
<div class="card">
<input id="clienteNome" placeholder="Nome do Cliente">
<select id="servicoSelect"></select>
<select id="profissionalSelect"></select>
<input type="date" id="dataAgendamento">
<input type="time" id="horaAgendamento">
<button onclick="agendar()">Confirmar Agendamento</button>
</div>
</div>

<div id="agendei" class="tab hidden">
<div class="card">
<h3>Agendamentos</h3>
<div id="listaAgendamentos"></div>
</div>
</div>

<div id="config" class="tab hidden">

<div class="card">
<h3>Serviços</h3>
<input id="novoServico" placeholder="Nome do serviço">
<input id="duracaoServico" placeholder="Duração (minutos)">
<button onclick="addServico()">Adicionar</button>
<div id="listaServicos"></div>
</div>

<div class="card">
<h3>Profissionais</h3>
<input id="novoProfissional" placeholder="Nome">
<input id="whatsProfissional" placeholder="WhatsApp">
<button onclick="addProfissional()">Adicionar</button>
<div id="listaProfissionais"></div>
</div>

<div class="card">
<h3>Mensagem Cliente</h3>
<textarea id="msgCliente" style="width:100%;height:80px;"></textarea>
</div>

<div class="card">
<h3>Mensagem Profissional</h3>
<textarea id="msgProfissional" style="width:100%;height:80px;"></textarea>
</div>

</div>

</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAxyovmqjNYIzOYYDZZnduquiJQeK4UIgc",
  authDomain: "agendei-d721e.firebaseapp.com",
  projectId: "agendei-d721e",
  storageBucket: "agendei-d721e.firebasestorage.app",
  messagingSenderId: "525023801595",
  appId: "1:525023801595:web:71a6d72e986e6e9e30005e",
  measurementId: "G-YQP41N6MJ3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const loginScreen = document.getElementById("loginScreen");
const appScreen = document.getElementById("app");
  
window.login = async function(){
await signInWithEmailAndPassword(auth,email.value,senha.value);
}

window.logout = function(){
signOut(auth);
}

onAuthStateChanged(auth,(user)=>{
if(user){
loginScreen.classList.add("hidden");
appScreen.classList.remove("hidden");
loadData();
}else{
loginScreen.classList.remove("hidden");
appScreen.classList.add("hidden");
}
});

window.showTab=function(tab){
document.querySelectorAll(".tab").forEach(t=>t.classList.add("hidden"));
document.getElementById(tab).classList.remove("hidden");
tituloAba.innerText=tab.charAt(0).toUpperCase()+tab.slice(1);
}

window.toggleDark=function(){
document.body.classList.toggle("dark");
}

async function loadData(){
loadServicos();
loadProfissionais();
loadAgendamentos();
}

async function addServico(){
await addDoc(collection(db,"servicos"),{
nome:novoServico.value,
duracao:duracaoServico.value
});
novoServico.value="";
duracaoServico.value="";
loadServicos();
}

async function loadServicos(){
servicoSelect.innerHTML="";
listaServicos.innerHTML="";
const query=await getDocs(collection(db,"servicos"));
query.forEach(doc=>{
let data=doc.data();
servicoSelect.innerHTML+=`<option>${data.nome}</option>`;
listaServicos.innerHTML+=`<div>${data.nome} (${data.duracao}min)</div>`;
});
}

async function addProfissional(){
await addDoc(collection(db,"profissionais"),{
nome:novoProfissional.value,
whatsapp:whatsProfissional.value
});
novoProfissional.value="";
whatsProfissional.value="";
loadProfissionais();
}

async function loadProfissionais(){
profissionalSelect.innerHTML="";
listaProfissionais.innerHTML="";
const query=await getDocs(collection(db,"profissionais"));
query.forEach(doc=>{
let data=doc.data();
profissionalSelect.innerHTML+=`<option>${data.nome}</option>`;
listaProfissionais.innerHTML+=`<div>${data.nome} - ${data.whatsapp}</div>`;
});
}

async function agendar(){
await addDoc(collection(db,"agendamentos"),{
cliente:clienteNome.value,
servico:servicoSelect.value,
profissional:profissionalSelect.value,
data:dataAgendamento.value,
hora:horaAgendamento.value
});
clienteNome.value="";
loadAgendamentos();
}

async function loadAgendamentos(){
listaAgendamentos.innerHTML="";
const query=await getDocs(collection(db,"agendamentos"));
query.forEach(doc=>{
let d=doc.data();
listaAgendamentos.innerHTML+=`
<div class="agendamento-item">
<strong>${d.data} ${d.hora}</strong><br>
Cliente: ${d.cliente}<br>
Serviço: ${d.servico}<br>
Profissional: ${d.profissional}
</div>
`;
});
}
</script>

</body>
</html>

